---
# tasks file for ansible-role-kube-devops-tools
# NFS Client Provisioner
- name: Copy the nfs-client-provisioner_values.yml template
  template: 
    src: nfs-client-provisioner_values.yml.j2
    dest: ~/nfs-client-provisioner_values.yml
    mode: '0644'
- name: Install nfs-client-provisioner
  command: /usr/local/bin/helm install --values ~/nfs-client-provisioner_values.yml --name nfs-client-provisioner stable/nfs-client-provisioner
  register: result
- name: Display nfs-client-provisioner output
  debug:
    var: result.stdout_lines
# Ingress Nginx Proxy
- name: Copy the nginx-ingress_values.yml.j2 template
  template:
    src: nginx-ingress_values.yml.j2 
    dest: ~/nginx-ingress_values.yml
    mode: '0644'
- name: Install nginx-ingress
  command: /usr/local/bin/helm install --values ~/nginx-ingress_values.yml --name nginx-ingress stable/nginx-ingress
  register: result
- name: Display nginx-ingress output
  debug:
    var: result.stdout_lines
# kubernetes-dashboard UI v2.0.0-beta4
#- name: Copy the kube_dashboard_role_update.yml file
#  copy:
#    src: kube_dashboard_role_update.yml
#    dest: ~/kube_dashboard_role_update.yml
#    mode: '0754'
#- name: Enable the Web UI
#  command: kubectl apply -f {{ dashboard_ui }}
#- name: Update the role so it can list the namespaces
#  command: kubectl apply -f /root/kube_dashboard_role_update.yml
#
# kubernetes-dashboard UI in ns kube-system v1.10.1
- name: Copy the kubernetes-dashboard_values.yml.j2 template
  template: 
    src: kubernetes-dashboard_values.yml.j2
    dest: ~/kubernetes-dashboard_values.yml
    mode: '0644'
- name: kubernetes-dashboard
  command: /usr/local/bin/helm install --values ~/kubernetes-dashboard_values.yml --name kubernetes-dashboard stable/kubernetes-dashboard
  register: result
- name: Display kubernetes-dashboard output
  debug:
    var: result.stdout_lines
# Prometheus
#- name: Copy the prometheus_values.yml.j2 template
#  template: 
#    src: prometheus_values.yml.j2 
#    dest: ~/prometheus_values.yml
#    mode: '0644'
#- name: Install Prometheus
#  command: /usr/local/bin/helm install --values ~/prometheus_values.yml --name prometheus stable/prometheus
#  register: result
#- name: Display Prometheus output
#  debug:
#    var: result.stdout_lines
#- name: Install Jenkins Master
#  become_user: "{{ linux_user }}"
#  command: /usr/local/bin/helm install --set persistence.existingClaim=jenkins-vol-claim --set master.adminPassword={{ Jenkins_Admin_Password }} --name my-jenkins stable/jenkins 
#- name: Install Kibana
#  become_user: "{{ linux_user }}"
#  command: /usr/local/bin/helm install --name my-kybana stable/kibana
